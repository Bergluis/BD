CREATE DATABASE D
DEFAULT CHARSET UTF8
COLLATE UTF8_GENERAL_CI;

USE D;

CREATE TABLE clientes(
id INT UNSIGNED NOT NULL PRIMARY KEY UNIQUE AUTO_INCREMENT,
nome VARCHAR(200) NOT NULL,
n_cartao_multib VARCHAR(30) NOT NULL
);

CREATE TABLE compra(
id INT UNSIGNED NOT NULL PRIMARY KEY UNIQUE AUTO_INCREMENT,
data_compra DATE NOT NULL,
id_cliente INT UNSIGNED NOT NULL,
CONSTRAINT fk1
FOREIGN KEY (id_cliente)
REFERENCES clientes(id)
);

CREATE TABLE produto(
id INT UNSIGNED NOT NULL PRIMARY KEY UNIQUE AUTO_INCREMENT,
nome VARCHAR(200) NOT NULL,
preco_unitario DECIMAL(15,3) NOT NULL
);

CREATE TABLE linha_compra(
id_compra INT UNSIGNED NOT NULL,
id_produto INT UNSIGNED NOT NULL,
quantidade DECIMAL(15,3) NOT NULL,
CONSTRAINT fk2
FOREIGN KEY (id_compra)
REFERENCES compra(id),
CONSTRAINT fk3
FOREIGN KEY (id_produto)
REFERENCES produto(id)
);